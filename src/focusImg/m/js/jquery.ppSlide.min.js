;(function($){var p={};p.M=function($t,opts){this._o=opts;this.$l=$t;this.$s=$t.find("."+opts.clSlider);this.$sA=$t.find("."+opts.clSliderHandle);this.$p=$t.find("."+opts.clPanel);this.$ct=$t.find("."+opts.clContent);this.$ing=$t.find("."+opts.clLoading);this.$boxes=this.$ct.children();this.wCT=this.$boxes.length*this.$boxes.eq(0).width();this.$ct.css("width",this.wCT);this.wP=this.$p.width();this.wCTGap=this.wCT-this.wP;this.wScrollMax=this.$s.width()-this.$sA.width();this.factorCT=this.wCTGap/this.wScrollMax;this.tm=null;this._i();};p.M.prototype={_i:function(){var _this=this,step;this.$sA.draggable({axis:'x',drag:function(evt,ui){if(_this.wCTGap<=0)return;step=Math.round(ui.position.left*_this.factorCT);_this.$ct.css("margin-left",-step);},containment:'parent'}).click(function(e){return false;});this.$sA.css({left:this.wScrollMax/2});this.$ct.css({'margin-left':-this.wCTGap/2});this.$l.find(this._o.cssThumb).css('opacity',this._o.opacity);this.$l.find(this._o.cssItem).mouseenter(function(){_this.z($(this));});this.$l.find(".lv_zoom img").load(function(){_this.$ing.remove();});this.$l.find(".lv_ovl").css("opacity",0.6);this.$l.find(".lv_init").trigger("mouseenter");},z:function($t){if($t.nextAll(".lv_cover").is(":visible"))return;var items=this.$l.find(".lv_cover:visible"),_this=this,$cv,d,$img,$z,$n,$ia;this.$l.find("."+this._o.clCover).stop(true,true);if(items.length>1){if($t.index()%2==0){items.eq(1).hide();}else{items.eq(0).hide();};}else{items.hide();};$ia=$t.find("a");d=$.evalJSON($ia.attr("rel"));$cv=$t.nextAll("."+_this._o.clCover).animate({height:"hide",width:"hide"},0).animate({height:"show",width:"show"},_this._o.speed,"linear",function(){$cv.find(".lv_ovl,.lv_note").fadeIn("normal");_this.adjust($cv);});$cv.append(_this.$ing.show().remove());$img=$t.find("img");d.p=$img.attr("alt");d.p=d.p==""?$img.attr("src"):d.p;$n=$cv.find(".lv_ovl,.lv_note").hide().filter(".lv_note").find(".lv_t").html("").end();$z=$cv.find(".lv_zoom").attr("href",$ia[0].href);$cv.find(".lv_t0").html(d.t0);$cv.find(".lv_t1").html(d.t1);$z.find("img").attr("src",d.p);},adjust:function($cv){var boxIndex=$cv.parent().index(),wCV=$cv.width();var ml=parseInt(this.$ct.css("margin-left"));var gapRight=(boxIndex+1)*wCV+ml-this.wP;var gapLeft=boxIndex*wCV+ml;ml=isNaN(ml)?0:ml;if(gapLeft<0){this.s(true,-gapLeft);return;};if(gapRight>0){this.s(false,gapRight);};},s:function(toRight,val){var step;var val0=val/this.factorCT;if(toRight){val="+="+val;step="-="+val0;}else{val="-="+val;step="+="+val0;};this.$ct.stop(true,true).animate({"margin-left":val});this.$sA.stop(true,true).animate({"left":step});}};$.fn.ppSlide=function(opts){opts=$.extend({},$.fn.ppSlide.defaults,opts);return this.each(function(){new p.M($(this),opts);});};$.fn.ppSlide.defaults={clSlider:'lv_slider_',clSliderHandle:"lv_slider_hdl",clPanel:'lv_main',clContent:'lv_main_',cssItem:'.lv_item',cssThumb:'.lv_item img',clCover:'lv_cover',clLoading:'lv_loading',opacity:0.7,speed:500};})(jQuery);